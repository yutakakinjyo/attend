<h1><%= @course.name %></h1>

<% if user_signed_in? %>
  <% if current_user.join?(@course.id) %>
    <%= form_for(@course_detail, method: :delete) do |f| %>
      <%= f.submit "Leave" %>
    <% end %>
  <% else %>
    <%= form_for(@course_detail) do |f| %>
      <%= f.hidden_field :user_id, :value => current_user.id %>
      <%= f.hidden_field :course_id, :value => @course.id %>
      <%= f.submit "Join" %>
    <% end %>
  <% end %>
<% end %>

<h2>Members</h2>
<% @course.users.each do |user| %>
  <li><%= user.name %> <% if current_user.attend?(@course.id) %> ✓ <% end %></li>
<% end %>

<h2><%= @current_month %> Attends</h2>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <% @course.current_days.each do |day| %>
        <th><%= day %></th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @course.users.each do |user| %>
      <tr>
        <td><%= user.name %></td>
	<% @course.current_days.each do |day| %>
	  <td>
	  <% if current_user.attend_by_day?(@course.id, day) %>
	    ✓ 
	  <% end %>
	  </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
